@using BSNTools.Web.Core
@inject MessageBoxService MbService

@if (isVisible)
{
    <div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: repeating-conic-gradient(transparent 0% 25%, rgba(0, 0, 0, 1) 0% 50%) 50% / 4px 6px; z-index: 9999;">
        
        <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);">
            <Window Title="@title" Width="300">
                <Content>
                    <div style="padding: 10px; text-align: center;">
                        <p style="margin-bottom: 20px;">@message</p>
                        
                        <div class="action-buttons" style="justify-content: center;">
                            @if (buttons == MessageBoxButtons.OK || buttons == MessageBoxButtons.OKCancel)
                            {
                                <button @onclick="() => Close(MessageBoxResult.OK)">OK</button>
                            }
                            @if (buttons == MessageBoxButtons.YesNo)
                            {
                                <button @onclick="() => Close(MessageBoxResult.Yes)">Ja</button>
                                <button @onclick="() => Close(MessageBoxResult.No)">Nein</button>
                            }
                            @if (buttons == MessageBoxButtons.OKCancel)
                            {
                                <button @onclick="() => Close(MessageBoxResult.Cancel)">Abbrechen</button>
                            }
                        </div>
                    </div>
                </Content>
            </Window>
        </div>
    </div>
}

@code {
    private bool isVisible;
    private string title = "";
    private string message = "";
    private MessageBoxButtons buttons;

    protected override void OnInitialized()
    {
        MbService.OnShow += Show;
        MbService.OnHide += Hide;
    }

    private void Show(string t, string m, MessageBoxButtons b)
    {
        title = t;
        message = m;
        buttons = b;
        isVisible = true;
        StateHasChanged();
    }

    private void Hide()
    {
        isVisible = false;
        StateHasChanged();
    }

    private void Close(MessageBoxResult result)
    {
        MbService.Close(result);
    }

    public void Dispose()
    {
        MbService.OnShow -= Show;
        MbService.OnHide -= Hide;
    }
}