@using BSNTools.Web.Core
@inject CustomDialogService CustomDialogService
@implements IDisposable

@if (isVisible)
{
    <div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: repeating-conic-gradient(transparent 0% 25%, rgba(0, 0, 0, 1) 0% 50%) 50% / 4px 6px; z-index: 9999;">

        <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); border-left: 2px solid black; border-right: 2px solid black;">
            <Window Title="@title" Width="@(width ?? 400)">
                <Content>
                    <div style="padding: 10px;">
                        @content
                    </div>
                </Content>
            </Window>
        </div>
    </div>
}

@code {
    private bool isVisible;
    private string title = "";
    private RenderFragment? content;
    private int? width;

    protected override void OnInitialized()
    {
        CustomDialogService.OnShow += Show;
        CustomDialogService.OnHide += Hide;
    }

    private void Show(string t, RenderFragment c, int? w)
    {
        title = t;
        content = c;
        width = w;
        isVisible = true;
        StateHasChanged();
    }

    private void Hide()
    {
        isVisible = false;
        StateHasChanged();
    }

    public void Dispose()
    {
        CustomDialogService.OnShow -= Show;
        CustomDialogService.OnHide -= Hide;
    }
}
